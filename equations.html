<!DOCTYPE html>
<html class="writer-html4" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Rough surface generation &mdash; Pyrough  documentation</title><link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
      <script>
          var DOCUMENTATION_OPTIONS = {
              URL_ROOT:'./',
              VERSION:'',
              LANGUAGE:'None',
              COLLAPSE_INDEX:false,
              FILE_SUFFIX:'.html',
              HAS_SOURCE:  true,
              SOURCELINK_SUFFIX: '.txt'
          };
      </script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Package functions" href="functions.html" />
    <link rel="prev" title="Installation" href="installation.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> Pyrough<img src="_static/Logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Rough surface generation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#spatial-frequencies">Spatial frequencies</a></li>
<li class="toctree-l2"><a class="reference internal" href="#elementary-waves">Elementary waves</a></li>
<li class="toctree-l2"><a class="reference internal" href="#associated-amplitudes">Associated Amplitudes</a></li>
<li class="toctree-l2"><a class="reference internal" href="#periodicity">Periodicity</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="functions.html">Package functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="shapes.html">Generation of rough shapes</a></li>
<li class="toctree-l1"><a class="reference internal" href="biblio.html">Bibliography</a></li>
<li class="toctree-l1"><a class="reference internal" href="credits.html">Credits</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Pyrough</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Rough surface generation</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/equations.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="rough-surface-generation">
<h1>Rough surface generation<a class="headerlink" href="#rough-surface-generation" title="Permalink to this headline">¶</a></h1>
<p>The characterization of a rough surface can be done with respect to its spatial frequency content. This can be transformed into a constructive method by using a sum of trigonometric functions similar to a Fourier series. Each term in such a sum represents a certain frequency of spatial oscillation.</p>
<div class="section" id="spatial-frequencies">
<h2>Spatial frequencies<a class="headerlink" href="#spatial-frequencies" title="Permalink to this headline">¶</a></h2>
<p>The mathematical expression of oscillations over time is given by <span class="math">\(cos(2\pi f t)\)</span> with <span class="math">\(f\)</span> the time frenquency in Hz.
In the case of spatial oscilations, we simply have to replace time variables by spatial ones:</p>
<div class="math">
\[cos(2 \pi \nu x)\]</div>
<p>with <span class="math">\(\nu\)</span> the spatial frequency in <span class="math">\(m^{-1}\)</span>.</p>
<p>In the case of 2D and Cartesian coordinates, we have:</p>
<div class="math">
\[cos(2 \pi ( \nu_x x + \nu_y y)) = cos(\vec{k}.\vec{x})\]</div>
<p>where <span class="math">\(\vec{k} = (k_x,k_y) = (2\pi \nu_x,2\pi \nu_y)\)</span> is the wave vector representing the direction of the wave and <span class="math">\(\vec{x} = (x,y)\)</span> the position vector.</p>
</div>
<div class="section" id="elementary-waves">
<h2>Elementary waves<a class="headerlink" href="#elementary-waves" title="Permalink to this headline">¶</a></h2>
<p>A rough surface <span class="math">\(z(x,y)\)</span> is composed of several elementary waves:</p>
<div class="math">
\[cos(\vec{k}.\vec{x} + \phi)\]</div>
<p>where <span class="math">\(\phi\)</span> is a phase angle.</p>
<p>Due to the relationship <span class="math">\(sin(\theta) = cos(\frac{\pi}{2} - \theta)\)</span>, there is no influence of using either sines or cosines.</p>
<p>For a random surface construction, the phase angle <span class="math">\(\phi\)</span> can be any value in the interval <span class="math">\([0;\pi]\)</span> or <span class="math">\([-\frac{\pi}{2};\frac{\pi}{2}]\)</span>.
It follows then a uniform random distribution in such an interval of length <span class="math">\(\pi\)</span>.
It is important to notice that there may be end-point or wrap-around effects if we choose an interval with a size bigger than <span class="math">\(\pi\)</span>.
This is due to the cosine function being its own mirror image in steps of <span class="math">\(\pi\)</span>, according to <span class="math">\(cos(\pi - \theta) = -cos(\theta)\)</span>.</p>
<p>In order to include this formulation in computational simulations, a discrete set of spatial frequencies is needed : <span class="math">\(\nu_x = m\)</span> and <span class="math">\(\nu_y = n\)</span>, where <span class="math">\(m\)</span> and <span class="math">\(n\)</span> are integers.</p>
<p>We define <span class="math">\(M\)</span> and <span class="math">\(N\)</span> as respective high-frequency cutoffs for <span class="math">\(m\)</span> and <span class="math">\(n\)</span> so that <span class="math">\(m \in ⟦-M;M⟧\)</span> and <span class="math">\(n \in ⟦-N;N⟧\)</span>. This means that the shortest wavelengths being represented are respectively <span class="math">\(\lambda_{x,min} = \frac{1}{M}\)</span> and <span class="math">\(\lambda_{y,min} = \frac{1}{N}\)</span> for <span class="math">\(x\)</span> and <span class="math">\(y\)</span> directions.</p>
<p>A rough surface is then constituted of elementary waves of the form:</p>
<div class="math">
\[cos( \vec{k_{m,n}}.\vec{x} + \phi) = cos(2\pi (mx + ny) + \phi)\]</div>
<p>To get a method of synthesizing a surface with no preferred direction of oscillation, we let <span class="math">\(m\)</span> and <span class="math">\(n\)</span> take positive and negative values with equal probabilities</p>
</div>
<div class="section" id="associated-amplitudes">
<h2>Associated Amplitudes<a class="headerlink" href="#associated-amplitudes" title="Permalink to this headline">¶</a></h2>
<p>Each elementary wave has an associated amplitude so that each wave component has the form <span class="math">\(A_{m,n} cos( \vec{k_{m,n}}.\vec{x} + \phi)\)</span>.</p>
<p>The final surface is a sum over the wave components:</p>
<div class="math">
\[z(\vec{x}) = \sum_{m,n} A_{m,n} cos(\vec{k_{m,n}}.\vec{x} + \phi)\]</div>
<p>In order to obtain a more realistic rough surface, two more contributions should be made :</p>
<blockquote>
<div><ul class="simple">
<li>Since <span class="math">\(\phi\)</span> can take any value in an interval of length <span class="math">\(\pi\)</span> with the same probability, <span class="math">\(\phi = U(m,n)\)</span> where <span class="math">\(U\)</span> states for a random function with a uniform distribution.</li>
<li>Autocorrelation is implemented through <span class="math">\(A_{m,n}\)</span> which follows a Gaussian law. A Gaussian, or normal, distribution is chosen to get a smooth but random variation in amplitudes with no limit on the magnitude. Autocorrelation is important to modulate the Gaussian distribution and get credible roughness. It avoids or limits the presence of too rough peaks and valleys. Therefore, <span class="math">\(A_{m,n} = G(m,n).(m^2 + n^2)^{-\frac{b}{2}}\)</span> where <span class="math">\(G\)</span> states for a random function with a Gaussian distribution and <span class="math">\((m^2 + n^2)^{-\frac{b}{2}}\)</span> is the autocorrelation function.</li>
</ul>
</div></blockquote>
<p>To sum up, we can represent rough surfaces by the final equation:</p>
<div class="math">
\[z(x,y) = C_1 \sum^{M}_{m = -M} \sum^{N}_{n = -N} G(m,n).(m^2 + n^2)^{-\frac{b}{2}} cos[2 \pi (mx + ny) + U(m,n)]\]</div>
<p>Where <span class="math">\(C_1\)</span> is a normalization factor and <span class="math">\(b\)</span> is the spectral exponent that parameterizes how fast the high frequencies are attenuated.</p>
<div class="figure align-center" id="id1">
<img alt="_images/Influence_of_b.png" src="_images/Influence_of_b.png" />
<p class="caption"><span class="caption-text">Surfaces generated on the square <span class="math">\([0,1]×[0,1]\)</span> by superposing 50 frequencies with spectral exponents <span class="math">\(b = 1.5\)</span>, <span class="math">\(b = 1.8\)</span>, <span class="math">\(b = 2\)</span> and <span class="math">\(b = 2.2\)</span>, clockwise from the top-left image.</span></p>
</div>
</div>
<div class="section" id="periodicity">
<h2>Periodicity<a class="headerlink" href="#periodicity" title="Permalink to this headline">¶</a></h2>
<p>Due to its definition, the function <span class="math">\(z(x,y)\)</span> is periodic:</p>
<div class="math">
\[z(x+1,y) = C_1 \sum^{M}_{m = -M} \sum^{N}_{n = -N} G(m,n).(m^2 + n^2)^{-\frac{b}{2}} cos[2 \pi (mx + ny) + U(m,n) + 2m\pi] = z(x,y)\]</div>
<p>The same demonstration for <span class="math">\(z(x,y+1)\)</span> justifies the periodicity of the function on the interval <span class="math">\([0;1]×[0;1]\)</span>.
The surface is generated over a rectangle <span class="math">\([a; a + 1]×[b; b + 1]\)</span> or smaller in order to avoid spatial periodicity and pattern repetitions.</p>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="installation.html" class="btn btn-neutral float-left" title="Installation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="functions.html" class="btn btn-neutral float-right" title="Package functions" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Hugo Iteney.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>